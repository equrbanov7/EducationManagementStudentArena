{% extends "base.html" %}
{% load static %}

{% block title %}Gözləmə Otağı | {{ session.pin }}{% endblock %}

{% block extraCss %}
    <link rel="stylesheet" href="{% static 'css/wait_room.css' %}">
{% endblock %}

{% block content %}

    <div class="wait-card">
        <div class="success-msg">Sən Artıq İçəridəsən!</div>
        
        <div class="my-profile">
            <div id="myAvatar" class="my-avatar"></div> 
            <div id="myNickname" class="my-nickname">{{ my_nickname }}</div>
        </div>

        <div class="status-bar">
            Müəllim oyunu başladır<span class="loading-dots"></span>
        </div>
    </div>

    <div class="others-container">
        <div class="others-title">
            <span>Digər oyunçular:</span>
            <span id="count" style="background:white; color:#006064; padding:2px 8px; border-radius:10px;">0</span>
        </div>
        <div id="playersList" class="players-grid">
            </div>
    </div>

    <div class="lobby-info">
        <p>PIN: {{ session.pin }}</p>
        <small id="wsStatus" style="opacity:0.8;">Bağlantı...</small>
    </div>

    {{ players|json_script:"initialPlayers" }}

{% endblock %}

{% block extraJs %}
    <script>
        // Backend-dən gələn məlumatlar JS-ə ötürülür
        const CONFIG = {
            wsPath: `/ws/live/{{ session.pin }}/lobby/`,
            myNickname: "{{ my_nickname }}",     // View-da context-ə 'my_nickname' əlavə et
            myAvatarKey: "{{ my_avatar_key }}"   // View-da context-ə 'my_avatar_key' əlavə et
        };
    </script>
    <script src="{% static 'js/wait_room.js' %}"></script>
{% endblock %}